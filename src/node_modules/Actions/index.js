import {
	START,
	SUCCESS,
	FAILURE,
	LOGIN,
	LOGOUT
} from 'constants.js'

export function actionLogin(form){
	let {login, password} = form;
	// login = "'"+login+"'",
	// password = "'"+password+"'";
	console.log(login, password)
	return (dispatch) => {
		dispatch({
			type: LOGIN+START
		})
		fetch('https://mysterious-reef-29460.herokuapp.com/api/v1/validate', {
			method: 'post',
			headers: {
				'Accept': 'application/json, text/plain, */*',
				'Content-Type': 'application/json'
			},
			body: JSON.stringify({email: login, password: password})
		})
		.then(function (response) {
			return response.json();
		})
		.then(function (result) {
			console.log(result.status);
			switch( result.status ){
				case 'ok':
					return dispatch({
						type: LOGIN+SUCCESS
					})
				case 'err':
					return dispatch({
						type: LOGIN+FAILURE
				 	})
			}
		})
		.catch (function (error) {
			console.log('Request failed', error);
			return dispatch({
	 			type: LOGIN+FAILURE
	 		})
		});
	}
}

export function actionLogout(){
	return({
		type: LOGOUT
	})
}